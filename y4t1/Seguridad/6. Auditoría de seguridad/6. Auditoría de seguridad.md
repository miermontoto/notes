![[_resources/Auditoria_Seguridad.pdf]]

---

# Introducción
> [!info] Definción
> Revisión y examen independiente de los registros de las actividades de un sistema para:
> - Determinar la idoneidad de los controles
> - Asegurar el cumplimiento de las políticas
> - Detectar brechas
> - Recomendar cambios

**Registro de Auditoría de Seguridad RAS:** registro cronológico de las actividades del sistema que es suficiente para reconstruir y examinar la secuencia de entornos y actividades involucrados en una operación relevante para la seguridad.

**Objetivo**: establecer *responsabilidad* de entidades que participan en acciones relevantes de seguridad.
**Mecanismos para:**
1. Generar y grabar RAS
2. Revisar y analizar RAS

# Modelo
![[_resources/Pasted image 20231123151139.png]]

# Funciones
- Data generation
- Event selection
- Event storage
- Automatic response
- Audit analysis
- Audit review

**Esquema funcional**
![[_resources/Pasted image 20231123151212.png]]

# Registros
## Qué capturar
La cantidad de datos depende del rango de áreas de interés y la granularidad de la captura.
*Compromismo Cantidad - Eficiencia* ↓

**Selección de datos a capturar** (ejemplos)
![[_resources/Pasted image 20231123151535.png]]

**Áreas de monitorización sugeridas en ISO 27002**
1. Accesos autorizados
2. Todas las operaciones realizadas usando privilegios
3. Intentos de acceso no autorizados
4. Alertas por fallos
5. Cambios e intentos de cambio en las configuraciones y los controles de seguridad del sistema

## Ejemplos a varios niveles
- Registros a nivel de sistema
- Registros a nivel de aplicación
- Registros a nivel de usuario

## Protección de los registros
Los registros de auditoría deben ser protegidos para garantizar la **confidencialidad** y la **integridad** de los datos.

**Alternativas típicas para almacenar registros**
- Ficheros de lectura/escritura en un host
- Dispositivo de una escritura / múltiples lecturas (ej. CD/DVD)
- Dispositivo de solo escritura (ej. impresora)

# Implementación de la función de registro
Para obtener los registros ne los que basar la auditoría hay que implementar funciones que registren los datos necesarios. (hooks y triggers)

**Niveles**
- A nivel del SO
- A nivel del software de soporte
- A nivel de aplicación de usuario

## Registro de eventos de Windows
Windows incluye un sistema de captura y almacenamiento de eventos (Visor de Eventos)

**Categorías**: registros de windows, registros de aplicaciones y servicios
**Suscripciones:** permite recopilar copias de eventso de varios equipos remotos y almacenarlas localmente
**Propiedades de un evento:** origen, id, nivel, usuario, código operativo, registro, categoría de tarea, keywords, equipo, datetime.