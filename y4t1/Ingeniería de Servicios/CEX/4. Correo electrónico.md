![[_resources/T4-email.pdf]]

---

# Introducción
**Servicio:** envío de mensajes de texto (posteriormente, cualquier tipo de fichero) a otro usuario en otra máquina, de forma asíncrona.

## Entidades
- Remitente
- Desintatario
- **MUA** *Message User Agent*: el programa que usa el remitente para enviar, y el destinatario para recibir.
	- ej: outlook, interfaces web, thunderbird...
- **MTA** *Message Transfer Agent*: el programa que recibe el mensaje del MUA del remitente y lo transmite a otro MTA en una máquina a la que el destinartario tiene acceso.
	- microsoft exchange, sendmail, qmail, postfix...
- Buzón

## Arquitectura
![[_resources/Pasted image 20231031162532.png]]

# Cabeceras
- `From`: remitente
- `To`: destino
- `Reply-To`: quién debe recibir la respuesta
- `Cc`: carbon copy
- `Bcc`: blind carbon copy
- `Subject`
- `Date`
- `Message-Id`

Otras son añadidas por los MTA por donde pasa el mensaje:
- `Date`, `From`, `To`, `Message-Id` suelen ser añadidas por el primer MTA.
- `Received`: añadida por cada MTA atravesado por el mensaje, registra qué MTA lo recibe, de dónde procede y la fecha y hora.
- `Return-path`: añadida por el MTA destino.

# MIME
> [!warning] RELLENAR
> simplemente no me salió de los cojones

# SMTP
- Va sobre TCP
- El cliente puede ir autenticado o no
- Dos usos diferentes:
	1. Entre un MUA y un MTA (normalmente con autenticación)
	2. Entre dos MTA (normalmente sin cifrado)

## Características
- Orientado a mensajes de texto (HTTP)
	- **Petición:** comando + parámetros
	- **Respuesta:** código + descripción textual
	- **Terminador de línea:** CRLF
- Algunas peticiones pueden requerir más líneas después de la que lleva el comando
- Algunas respuestas también pueden ser varias líneas

## Comandos
![[_resources/Pasted image 20231108181242.png]]

El mensaje que sigue a `DATA` contiene las cabeceras (con terminación) y el cuerpo. Se considera finalizado al recibir una línea que contiene tan solo un punto (terminador = `\r\n.\r\n`)

## Respuestas
> [!success] "No necesitáis saberlos"

## Ejemplo de diálogo típico
*Tras establecer conexión TCP (puerto 25)*

![[_resources/Pasted image 20231108182407.png]]